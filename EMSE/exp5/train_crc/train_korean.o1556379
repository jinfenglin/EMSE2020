Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
ERROR: Unable to locate a modulefile for 'pytorch/1.7.0'
11/10/2020 02:40:25 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
11/10/2020 02:40:25 - INFO - transformers.configuration_utils -   loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-multilingual-cased-config.json from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/aee7490b1a48646df683dee12f25d9c63ebbf8dce1b7e1a656ce28830d9a7e86.bc76a47cb1c1c2984e48f23afbd3473a944ac1a2be9a8c8200092f5bf62153c9
11/10/2020 02:40:25 - INFO - transformers.configuration_utils -   Model config DistilBertConfig {
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "output_past": true,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "vocab_size": 119547
}

11/10/2020 02:40:25 - INFO - transformers.tokenization_utils_base -   loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-vocab.txt from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/96435fa287fbf7e469185f1062386e05a075cadbf6838b74da22bf64b080bc32.99bcd55fc66f4f3360bc49ba472b940b8dcf223ea6a345deb969d607ca900729
11/10/2020 02:40:25 - INFO - transformers.configuration_utils -   loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-multilingual-cased-config.json from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/aee7490b1a48646df683dee12f25d9c63ebbf8dce1b7e1a656ce28830d9a7e86.bc76a47cb1c1c2984e48f23afbd3473a944ac1a2be9a8c8200092f5bf62153c9
11/10/2020 02:40:25 - INFO - transformers.configuration_utils -   Model config DistilBertConfig {
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "output_past": true,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "vocab_size": 119547
}

11/10/2020 02:40:25 - INFO - transformers.modeling_utils -   loading weights file https://cdn.huggingface.co/distilbert-base-multilingual-cased-pytorch_model.bin from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/72a6c787412704a6fa6f5d9e5ef7d33c5b80c787e2bbc7d9ad82d7f88fb8f802.89fad86febf14521569023d312560283a922c0884a52f412eef4e96f91513ab2
11/10/2020 02:40:29 - INFO - transformers.modeling_utils -   All model checkpoint weights were used when initializing DistilBertModel.

11/10/2020 02:40:29 - INFO - transformers.modeling_utils -   All the weights of DistilBertModel were initialized from the model checkpoint at distilbert-base-multilingual-cased.
If your task is similar to the task the model of the ckeckpoint was trained on, you can already use DistilBertModel for predictions without further training.
11/10/2020 02:40:29 - INFO - transformers.configuration_utils -   loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-multilingual-cased-config.json from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/aee7490b1a48646df683dee12f25d9c63ebbf8dce1b7e1a656ce28830d9a7e86.bc76a47cb1c1c2984e48f23afbd3473a944ac1a2be9a8c8200092f5bf62153c9
11/10/2020 02:40:29 - INFO - transformers.configuration_utils -   Model config DistilBertConfig {
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "output_past": true,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "vocab_size": 119547
}

11/10/2020 02:40:29 - INFO - transformers.tokenization_utils_base -   loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-multilingual-cased-vocab.txt from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/96435fa287fbf7e469185f1062386e05a075cadbf6838b74da22bf64b080bc32.99bcd55fc66f4f3360bc49ba472b940b8dcf223ea6a345deb969d607ca900729
11/10/2020 02:40:30 - INFO - transformers.configuration_utils -   loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-multilingual-cased-config.json from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/aee7490b1a48646df683dee12f25d9c63ebbf8dce1b7e1a656ce28830d9a7e86.bc76a47cb1c1c2984e48f23afbd3473a944ac1a2be9a8c8200092f5bf62153c9
11/10/2020 02:40:30 - INFO - transformers.configuration_utils -   Model config DistilBertConfig {
  "activation": "gelu",
  "architectures": [
    "DistilBertForMaskedLM"
  ],
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "max_position_embeddings": 512,
  "model_type": "distilbert",
  "n_heads": 12,
  "n_layers": 6,
  "output_past": true,
  "pad_token_id": 0,
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "vocab_size": 119547
}

11/10/2020 02:40:30 - INFO - transformers.modeling_utils -   loading weights file https://cdn.huggingface.co/distilbert-base-multilingual-cased-pytorch_model.bin from cache at /afs/crc.nd.edu/user/j/jlin6/.cache/torch/transformers/72a6c787412704a6fa6f5d9e5ef7d33c5b80c787e2bbc7d9ad82d7f88fb8f802.89fad86febf14521569023d312560283a922c0884a52f412eef4e96f91513ab2
11/10/2020 02:40:34 - INFO - transformers.modeling_utils -   All model checkpoint weights were used when initializing DistilBertModel.

11/10/2020 02:40:34 - INFO - transformers.modeling_utils -   All the weights of DistilBertModel were initialized from the model checkpoint at distilbert-base-multilingual-cased.
If your task is similar to the task the model of the ckeckpoint was trained on, you can already use DistilBertModel for predictions without further training.
11/10/2020 02:40:37 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, data_dir='/afs/crc.nd.edu/user/j/jlin6/data/EMSE/awesome-berlin', device=device(type='cuda'), exp_name='ge', fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=2, hard_ratio=0.5, learning_rate=1e-05, local_rank=-1, logging_steps=10, max_grad_norm=1.0, max_steps=-1, model_path='/afs/crc.nd.edu/user/j/jlin6/projects/EMSE2020/EMSE/exp3/models/model1', n_gpu=1, neg_sampling='online', no_cuda=False, num_train_epochs=20.0, output_dir='./output', overwrite=True, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, save_epoch=5, save_steps=-1, seed=42, tbert_type='siamese', train_num=None, valid_epoch=5, valid_num=200, valid_step=-1, warmup_steps=0, weight_decay=0.0)
11/10/2020 02:40:37 - INFO - EMSE.BERTDataReader -   Creating examples from dataset file at /afs/crc.nd.edu/user/j/jlin6/data/EMSE/awesome-berlin/train
update feature:   0%|          | 0/60 [00:00<?, ?it/s]update feature:  78%|███████▊  | 47/60 [00:00<00:00, 446.37it/s]update feature: 100%|██████████| 60/60 [00:00<00:00, 498.76it/s]
update feature:   0%|          | 0/60 [00:00<?, ?it/s]update feature: 100%|██████████| 60/60 [00:00<00:00, 1196.66it/s]
11/10/2020 02:40:37 - INFO - EMSE.BERTDataReader -   Creating examples from dataset file at /afs/crc.nd.edu/user/j/jlin6/data/EMSE/awesome-berlin/valid
update feature:   0%|          | 0/7 [00:00<?, ?it/s]update feature: 100%|██████████| 7/7 [00:00<00:00, 716.12it/s]
update feature:   0%|          | 0/7 [00:00<?, ?it/s]update feature: 100%|██████████| 7/7 [00:00<00:00, 1954.09it/s]
11/10/2020 02:40:38 - INFO - __main__ -   ***** Running training *****
11/10/2020 02:40:38 - INFO - __main__ -     Num examples = 120
11/10/2020 02:40:38 - INFO - __main__ -     Num Epochs = 20
11/10/2020 02:40:38 - INFO - __main__ -     Instantaneous batch size per GPU = 4
11/10/2020 02:40:38 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 8
11/10/2020 02:40:38 - INFO - __main__ -     Gradient Accumulation steps = 2
11/10/2020 02:40:38 - INFO - __main__ -     Total optimization steps = 300
11/10/2020 02:40:38 - INFO - EMSE.utils -   Loading checkpoint from /afs/crc.nd.edu/user/j/jlin6/projects/EMSE2020/EMSE/exp3/models/model1, remove optimizer and scheduler if you do not want to load them
11/10/2020 02:40:44 - INFO - EMSE.utils -   Loading optimizer...
11/10/2020 02:40:58 - INFO - EMSE.utils -   Loading scheduler...
/afs/crc.nd.edu/user/j/jlin6/.local/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:234: UserWarning: Please also save or load the state of the optimizer when saving or loading the scheduler.
  warnings.warn(SAVE_STATE_WARNING, UserWarning)
11/10/2020 02:40:58 - INFO - __main__ -     Continuing training from checkpoint, will skip to saved global_step
11/10/2020 02:40:58 - INFO - __main__ -     Continuing training from epoch 0, global step 0
Epoch:   0%|          | 0/20 [00:00<?, ?it/s]
Steps:   0%|          | 0/300.0 [00:00<?, ?it/s][A
Steps:   0%|          | 1/300.0 [00:00<03:03,  1.63it/s][A
Steps:   1%|          | 2/300.0 [00:01<03:02,  1.63it/s][A
Steps:   1%|          | 3/300.0 [00:01<03:00,  1.64it/s][A
Steps:   1%|▏         | 4/300.0 [00:02<02:59,  1.65it/s][A
Steps:   2%|▏         | 5/300.0 [00:03<02:57,  1.66it/s][A
Steps:   2%|▏         | 6/300.0 [00:03<02:58,  1.65it/s][A
Steps:   2%|▏         | 7/300.0 [00:04<02:57,  1.65it/s][A
Steps:   3%|▎         | 8/300.0 [00:04<02:56,  1.65it/s][A
Steps:   3%|▎         | 9/300.0 [00:05<02:55,  1.66it/s][A
Steps:   3%|▎         | 10/300.0 [00:06<02:55,  1.66it/s][A
Steps:   4%|▎         | 11/300.0 [00:06<02:54,  1.66it/s][A
Steps:   4%|▍         | 12/300.0 [00:07<02:53,  1.66it/s][A
Steps:   4%|▍         | 13/300.0 [00:07<02:53,  1.65it/s][A
Steps:   5%|▍         | 14/300.0 [00:08<02:53,  1.65it/s][A
Steps:   5%|▌         | 15/300.0 [00:09<02:52,  1.65it/s][A11/10/2020 02:41:07 - INFO - EMSE.utils -   Saving checkpoint to ./output/ge_11-10_02-40-38/epoch-ckp-0
/afs/crc.nd.edu/user/j/jlin6/.local/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:216: UserWarning: Please also save or load the state of the optimizer when saving or loading the scheduler.
  warnings.warn(SAVE_STATE_WARNING, UserWarning)


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 80.74it/s]


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 80.29it/s]


random_neg_sampling_dataset:   0%|          | 0/7 [00:00<?, ?it/s][A[Arandom_neg_sampling_dataset: 100%|██████████| 7/7 [00:00<00:00, 23136.43it/s]


Classify Evaluating:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Classify Evaluating:  50%|█████     | 2/4 [00:00<00:00, 12.01it/s][A[A

Classify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 12.87it/s][A[AClassify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 13.50it/s]
                                             
                                                         [AEpoch:   0%|          | 0/20 [00:34<?, ?it/s]
Steps:   5%|▌         | 15/300.0 [00:34<02:52,  1.65it/s][A

retrival evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

retrival evaluation:  54%|█████▍    | 7/13 [00:00<00:00, 68.17it/s][A[Aretrival evaluation: 100%|██████████| 13/13 [00:00<00:00, 71.36it/s]
Epoch:   5%|▌         | 1/20 [00:34<10:52, 34.32s/it]
Steps:   5%|▌         | 16/300.0 [00:34<38:43,  8.18s/it][A
Steps:   6%|▌         | 17/300.0 [00:35<27:51,  5.91s/it][A
Steps:   6%|▌         | 18/300.0 [00:36<20:17,  4.32s/it][A
Steps:   6%|▋         | 19/300.0 [00:36<14:59,  3.20s/it][A
Steps:   7%|▋         | 20/300.0 [00:37<11:18,  2.42s/it][A
Steps:   7%|▋         | 21/300.0 [00:37<08:44,  1.88s/it][A
Steps:   7%|▋         | 22/300.0 [00:38<06:56,  1.50s/it][A
Steps:   8%|▊         | 23/300.0 [00:39<05:40,  1.23s/it][A
Steps:   8%|▊         | 24/300.0 [00:39<04:48,  1.04s/it][A
Steps:   8%|▊         | 25/300.0 [00:40<04:10,  1.10it/s][A
Steps:   9%|▊         | 26/300.0 [00:40<03:44,  1.22it/s][A
Steps:   9%|▉         | 27/300.0 [00:41<03:26,  1.32it/s][A
Steps:   9%|▉         | 28/300.0 [00:42<03:13,  1.41it/s][A
Steps:  10%|▉         | 29/300.0 [00:42<03:04,  1.47it/s][A
Steps:  10%|█         | 30/300.0 [00:43<02:57,  1.52it/s][AEpoch:  10%|█         | 2/20 [00:43<08:01, 26.75s/it]
Steps:  10%|█         | 31/300.0 [00:44<02:53,  1.55it/s][A
Steps:  11%|█         | 32/300.0 [00:44<02:50,  1.58it/s][A
Steps:  11%|█         | 33/300.0 [00:45<02:46,  1.60it/s][A
Steps:  11%|█▏        | 34/300.0 [00:45<02:43,  1.63it/s][A
Steps:  12%|█▏        | 35/300.0 [00:46<02:42,  1.63it/s][A
Steps:  12%|█▏        | 36/300.0 [00:47<02:41,  1.63it/s][A
Steps:  12%|█▏        | 37/300.0 [00:47<02:40,  1.64it/s][A
Steps:  13%|█▎        | 38/300.0 [00:48<02:39,  1.64it/s][A
Steps:  13%|█▎        | 39/300.0 [00:48<02:38,  1.64it/s][A
Steps:  13%|█▎        | 40/300.0 [00:49<02:38,  1.64it/s][A
Steps:  14%|█▎        | 41/300.0 [00:50<02:37,  1.64it/s][A
Steps:  14%|█▍        | 42/300.0 [00:50<02:36,  1.65it/s][A
Steps:  14%|█▍        | 43/300.0 [00:51<02:36,  1.64it/s][A
Steps:  15%|█▍        | 44/300.0 [00:51<02:36,  1.64it/s][A
Steps:  15%|█▌        | 45/300.0 [00:52<02:34,  1.65it/s][AEpoch:  15%|█▌        | 3/20 [00:52<06:04, 21.46s/it]
Steps:  15%|█▌        | 46/300.0 [00:53<02:34,  1.64it/s][A
Steps:  16%|█▌        | 47/300.0 [00:53<02:33,  1.64it/s][A
Steps:  16%|█▌        | 48/300.0 [00:54<02:33,  1.64it/s][A
Steps:  16%|█▋        | 49/300.0 [00:54<02:32,  1.64it/s][A
Steps:  17%|█▋        | 50/300.0 [00:55<02:31,  1.65it/s][A
Steps:  17%|█▋        | 51/300.0 [00:56<02:31,  1.65it/s][A
Steps:  17%|█▋        | 52/300.0 [00:56<02:30,  1.65it/s][A
Steps:  18%|█▊        | 53/300.0 [00:57<02:30,  1.65it/s][A
Steps:  18%|█▊        | 54/300.0 [00:57<02:29,  1.65it/s][A
Steps:  18%|█▊        | 55/300.0 [00:58<02:28,  1.65it/s][A
Steps:  19%|█▊        | 56/300.0 [00:59<02:28,  1.65it/s][A
Steps:  19%|█▉        | 57/300.0 [00:59<02:28,  1.64it/s][A
Steps:  19%|█▉        | 58/300.0 [01:00<02:27,  1.64it/s][A
Steps:  20%|█▉        | 59/300.0 [01:01<02:26,  1.65it/s][A
Steps:  20%|██        | 60/300.0 [01:01<02:26,  1.64it/s][AEpoch:  20%|██        | 4/20 [01:01<04:44, 17.76s/it]
Steps:  20%|██        | 61/300.0 [01:02<02:26,  1.64it/s][A
Steps:  21%|██        | 62/300.0 [01:02<02:25,  1.64it/s][A
Steps:  21%|██        | 63/300.0 [01:03<02:24,  1.64it/s][A
Steps:  21%|██▏       | 64/300.0 [01:04<02:24,  1.64it/s][A
Steps:  22%|██▏       | 65/300.0 [01:04<02:23,  1.64it/s][A
Steps:  22%|██▏       | 66/300.0 [01:05<02:22,  1.64it/s][A
Steps:  22%|██▏       | 67/300.0 [01:05<02:22,  1.64it/s][A
Steps:  23%|██▎       | 68/300.0 [01:06<02:21,  1.64it/s][A
Steps:  23%|██▎       | 69/300.0 [01:07<02:21,  1.64it/s][A
Steps:  23%|██▎       | 70/300.0 [01:07<02:20,  1.64it/s][A
Steps:  24%|██▎       | 71/300.0 [01:08<02:19,  1.64it/s][A
Steps:  24%|██▍       | 72/300.0 [01:08<02:19,  1.64it/s][A
Steps:  24%|██▍       | 73/300.0 [01:09<02:18,  1.64it/s][A
Steps:  25%|██▍       | 74/300.0 [01:10<02:17,  1.64it/s][A
Steps:  25%|██▌       | 75/300.0 [01:10<02:17,  1.64it/s][AEpoch:  25%|██▌       | 5/20 [01:10<03:47, 15.18s/it]
Steps:  25%|██▌       | 76/300.0 [01:11<02:16,  1.64it/s][A
Steps:  26%|██▌       | 77/300.0 [01:12<02:16,  1.64it/s][A
Steps:  26%|██▌       | 78/300.0 [01:12<02:15,  1.63it/s][A
Steps:  26%|██▋       | 79/300.0 [01:13<02:14,  1.64it/s][A
Steps:  27%|██▋       | 80/300.0 [01:13<02:14,  1.64it/s][A
Steps:  27%|██▋       | 81/300.0 [01:14<02:13,  1.64it/s][A
Steps:  27%|██▋       | 82/300.0 [01:15<02:12,  1.65it/s][A
Steps:  28%|██▊       | 83/300.0 [01:15<02:12,  1.63it/s][A
Steps:  28%|██▊       | 84/300.0 [01:16<02:12,  1.63it/s][A
Steps:  28%|██▊       | 85/300.0 [01:16<02:11,  1.63it/s][A
Steps:  29%|██▊       | 86/300.0 [01:17<02:11,  1.63it/s][A
Steps:  29%|██▉       | 87/300.0 [01:18<02:10,  1.63it/s][A
Steps:  29%|██▉       | 88/300.0 [01:18<02:10,  1.63it/s][A
Steps:  30%|██▉       | 89/300.0 [01:19<02:09,  1.63it/s][A
Steps:  30%|███       | 90/300.0 [01:19<02:08,  1.63it/s][A11/10/2020 02:42:18 - INFO - EMSE.utils -   Saving checkpoint to ./output/ge_11-10_02-40-38/epoch-ckp-5


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 79.51it/s]


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 82.04it/s]


random_neg_sampling_dataset:   0%|          | 0/7 [00:00<?, ?it/s][A[Arandom_neg_sampling_dataset: 100%|██████████| 7/7 [00:00<00:00, 62203.66it/s]


Classify Evaluating:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Classify Evaluating:  50%|█████     | 2/4 [00:00<00:00, 11.91it/s][A[A

Classify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 12.76it/s][A[AClassify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 13.39it/s]
                                                     
                                                         [AEpoch:  25%|██▌       | 5/20 [01:42<03:47, 15.18s/it]
Steps:  30%|███       | 90/300.0 [01:42<02:08,  1.63it/s][A

retrival evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

retrival evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 73.07it/s][A[Aretrival evaluation: 100%|██████████| 13/13 [00:00<00:00, 75.65it/s]
Epoch:  30%|███       | 6/20 [01:43<04:44, 20.31s/it]
Steps:  30%|███       | 91/300.0 [01:43<26:15,  7.54s/it][A
Steps:  31%|███       | 92/300.0 [01:44<18:55,  5.46s/it][A
Steps:  31%|███       | 93/300.0 [01:44<13:48,  4.00s/it][A
Steps:  31%|███▏      | 94/300.0 [01:45<10:15,  2.99s/it][A
Steps:  32%|███▏      | 95/300.0 [01:46<07:46,  2.27s/it][A
Steps:  32%|███▏      | 96/300.0 [01:46<06:01,  1.77s/it][A
Steps:  32%|███▏      | 97/300.0 [01:47<04:49,  1.43s/it][A
Steps:  33%|███▎      | 98/300.0 [01:47<03:58,  1.18s/it][A
Steps:  33%|███▎      | 99/300.0 [01:48<03:22,  1.01s/it][A
Steps:  33%|███▎      | 100/300.0 [01:49<02:58,  1.12it/s][A
Steps:  34%|███▎      | 101/300.0 [01:49<02:40,  1.24it/s][A
Steps:  34%|███▍      | 102/300.0 [01:50<02:28,  1.34it/s][A
Steps:  34%|███▍      | 103/300.0 [01:51<02:19,  1.41it/s][A
Steps:  35%|███▍      | 104/300.0 [01:51<02:13,  1.47it/s][A
Steps:  35%|███▌      | 105/300.0 [01:52<02:08,  1.51it/s][AEpoch:  35%|███▌      | 7/20 [01:52<03:40, 16.96s/it]
Steps:  35%|███▌      | 106/300.0 [01:52<02:05,  1.55it/s][A
Steps:  36%|███▌      | 107/300.0 [01:53<02:02,  1.57it/s][A
Steps:  36%|███▌      | 108/300.0 [01:54<02:00,  1.59it/s][A
Steps:  36%|███▋      | 109/300.0 [01:54<01:59,  1.60it/s][A
Steps:  37%|███▋      | 110/300.0 [01:55<01:57,  1.61it/s][A
Steps:  37%|███▋      | 111/300.0 [01:55<01:57,  1.62it/s][A
Steps:  37%|███▋      | 112/300.0 [01:56<01:54,  1.64it/s][A
Steps:  38%|███▊      | 113/300.0 [01:57<01:54,  1.63it/s][A
Steps:  38%|███▊      | 114/300.0 [01:57<01:54,  1.63it/s][A
Steps:  38%|███▊      | 115/300.0 [01:58<01:53,  1.63it/s][A
Steps:  39%|███▊      | 116/300.0 [01:58<01:52,  1.63it/s][A
Steps:  39%|███▉      | 117/300.0 [01:59<01:52,  1.63it/s][A
Steps:  39%|███▉      | 118/300.0 [02:00<01:51,  1.63it/s][A
Steps:  40%|███▉      | 119/300.0 [02:00<01:51,  1.63it/s][A
Steps:  40%|████      | 120/300.0 [02:01<01:49,  1.65it/s][AEpoch:  40%|████      | 8/20 [02:01<02:55, 14.62s/it]
Steps:  40%|████      | 121/300.0 [02:02<01:48,  1.64it/s][A
Steps:  41%|████      | 122/300.0 [02:02<01:48,  1.64it/s][A
Steps:  41%|████      | 123/300.0 [02:03<01:47,  1.65it/s][A
Steps:  41%|████▏     | 124/300.0 [02:03<01:46,  1.65it/s][A
Steps:  42%|████▏     | 125/300.0 [02:04<01:46,  1.64it/s][A
Steps:  42%|████▏     | 126/300.0 [02:05<01:46,  1.64it/s][A
Steps:  42%|████▏     | 127/300.0 [02:05<01:45,  1.64it/s][A
Steps:  43%|████▎     | 128/300.0 [02:06<01:45,  1.63it/s][A
Steps:  43%|████▎     | 129/300.0 [02:06<01:44,  1.63it/s][A
Steps:  43%|████▎     | 130/300.0 [02:07<01:44,  1.63it/s][A
Steps:  44%|████▎     | 131/300.0 [02:08<01:43,  1.63it/s][A
Steps:  44%|████▍     | 132/300.0 [02:08<01:43,  1.63it/s][A
Steps:  44%|████▍     | 133/300.0 [02:09<01:42,  1.62it/s][A
Steps:  45%|████▍     | 134/300.0 [02:09<01:42,  1.63it/s][A
Steps:  45%|████▌     | 135/300.0 [02:10<01:41,  1.63it/s][AEpoch:  45%|████▌     | 9/20 [02:10<02:22, 12.99s/it]
Steps:  45%|████▌     | 136/300.0 [02:11<01:40,  1.62it/s][A
Steps:  46%|████▌     | 137/300.0 [02:11<01:40,  1.63it/s][A
Steps:  46%|████▌     | 138/300.0 [02:12<01:39,  1.63it/s][A
Steps:  46%|████▋     | 139/300.0 [02:13<01:39,  1.61it/s][A
Steps:  47%|████▋     | 140/300.0 [02:13<01:39,  1.60it/s][A
Steps:  47%|████▋     | 141/300.0 [02:14<01:39,  1.59it/s][A
Steps:  47%|████▋     | 142/300.0 [02:14<01:39,  1.59it/s][A
Steps:  48%|████▊     | 143/300.0 [02:15<01:38,  1.60it/s][A
Steps:  48%|████▊     | 144/300.0 [02:16<01:37,  1.60it/s][A
Steps:  48%|████▊     | 145/300.0 [02:16<01:36,  1.61it/s][A
Steps:  49%|████▊     | 146/300.0 [02:17<01:35,  1.61it/s][A
Steps:  49%|████▉     | 147/300.0 [02:18<01:33,  1.63it/s][A
Steps:  49%|████▉     | 148/300.0 [02:18<01:33,  1.62it/s][A
Steps:  50%|████▉     | 149/300.0 [02:19<01:33,  1.62it/s][A
Steps:  50%|█████     | 150/300.0 [02:19<01:32,  1.62it/s][AEpoch:  50%|█████     | 10/20 [02:19<01:58, 11.89s/it]
Steps:  50%|█████     | 151/300.0 [02:20<01:32,  1.62it/s][A
Steps:  51%|█████     | 152/300.0 [02:21<01:31,  1.62it/s][A
Steps:  51%|█████     | 153/300.0 [02:21<01:30,  1.62it/s][A
Steps:  51%|█████▏    | 154/300.0 [02:22<01:29,  1.62it/s][A
Steps:  52%|█████▏    | 155/300.0 [02:22<01:29,  1.62it/s][A
Steps:  52%|█████▏    | 156/300.0 [02:23<01:28,  1.62it/s][A
Steps:  52%|█████▏    | 157/300.0 [02:24<01:28,  1.62it/s][A
Steps:  53%|█████▎    | 158/300.0 [02:24<01:27,  1.62it/s][A
Steps:  53%|█████▎    | 159/300.0 [02:25<01:27,  1.61it/s][A
Steps:  53%|█████▎    | 160/300.0 [02:26<01:26,  1.62it/s][A
Steps:  54%|█████▎    | 161/300.0 [02:26<01:26,  1.61it/s][A
Steps:  54%|█████▍    | 162/300.0 [02:27<01:24,  1.62it/s][A
Steps:  54%|█████▍    | 163/300.0 [02:27<01:24,  1.62it/s][A
Steps:  55%|█████▍    | 164/300.0 [02:28<01:24,  1.62it/s][A
Steps:  55%|█████▌    | 165/300.0 [02:29<01:23,  1.62it/s][A11/10/2020 02:43:27 - INFO - EMSE.utils -   Saving checkpoint to ./output/ge_11-10_02-40-38/epoch-ckp-10


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 79.84it/s]


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 83.71it/s]


random_neg_sampling_dataset:   0%|          | 0/7 [00:00<?, ?it/s][A[Arandom_neg_sampling_dataset: 100%|██████████| 7/7 [00:00<00:00, 41527.76it/s]


Classify Evaluating:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Classify Evaluating:  50%|█████     | 2/4 [00:00<00:00, 12.45it/s][A[A

Classify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 13.28it/s][A[AClassify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 13.89it/s]
                                                      
                                                          [AEpoch:  50%|█████     | 10/20 [02:54<01:58, 11.89s/it]
Steps:  55%|█████▌    | 165/300.0 [02:54<01:23,  1.62it/s][A

retrival evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

retrival evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 74.01it/s][A[Aretrival evaluation: 100%|██████████| 13/13 [00:00<00:00, 75.82it/s]
Epoch:  55%|█████▌    | 11/20 [02:54<02:48, 18.76s/it]
Steps:  55%|█████▌    | 166/300.0 [02:55<18:28,  8.27s/it][A
Steps:  56%|█████▌    | 167/300.0 [02:55<13:14,  5.97s/it][A
Steps:  56%|█████▌    | 168/300.0 [02:56<09:36,  4.37s/it][A
Steps:  56%|█████▋    | 169/300.0 [02:57<07:04,  3.24s/it][A
Steps:  57%|█████▋    | 170/300.0 [02:57<05:18,  2.45s/it][A
Steps:  57%|█████▋    | 171/300.0 [02:58<04:05,  1.90s/it][A
Steps:  57%|█████▋    | 172/300.0 [02:58<03:13,  1.51s/it][A
Steps:  58%|█████▊    | 173/300.0 [02:59<02:37,  1.24s/it][A
Steps:  58%|█████▊    | 174/300.0 [03:00<02:12,  1.05s/it][A
Steps:  58%|█████▊    | 175/300.0 [03:00<01:55,  1.09it/s][A
Steps:  59%|█████▊    | 176/300.0 [03:01<01:42,  1.21it/s][A
Steps:  59%|█████▉    | 177/300.0 [03:02<01:33,  1.31it/s][A
Steps:  59%|█████▉    | 178/300.0 [03:02<01:27,  1.39it/s][A
Steps:  60%|█████▉    | 179/300.0 [03:03<01:23,  1.46it/s][A
Steps:  60%|██████    | 180/300.0 [03:03<01:19,  1.52it/s][AEpoch:  60%|██████    | 12/20 [03:03<02:07, 15.88s/it]
Steps:  60%|██████    | 181/300.0 [03:04<01:16,  1.55it/s][A
Steps:  61%|██████    | 182/300.0 [03:05<01:15,  1.57it/s][A
Steps:  61%|██████    | 183/300.0 [03:05<01:13,  1.59it/s][A
Steps:  61%|██████▏   | 184/300.0 [03:06<01:12,  1.60it/s][A
Steps:  62%|██████▏   | 185/300.0 [03:06<01:11,  1.61it/s][A
Steps:  62%|██████▏   | 186/300.0 [03:07<01:10,  1.62it/s][A
Steps:  62%|██████▏   | 187/300.0 [03:08<01:09,  1.62it/s][A
Steps:  63%|██████▎   | 188/300.0 [03:08<01:09,  1.62it/s][A
Steps:  63%|██████▎   | 189/300.0 [03:09<01:08,  1.63it/s][A
Steps:  63%|██████▎   | 190/300.0 [03:09<01:08,  1.62it/s][A
Steps:  64%|██████▎   | 191/300.0 [03:10<01:08,  1.60it/s][A
Steps:  64%|██████▍   | 192/300.0 [03:11<01:07,  1.61it/s][A
Steps:  64%|██████▍   | 193/300.0 [03:11<01:06,  1.62it/s][A
Steps:  65%|██████▍   | 194/300.0 [03:12<01:05,  1.62it/s][A
Steps:  65%|██████▌   | 195/300.0 [03:13<01:04,  1.62it/s][AEpoch:  65%|██████▌   | 13/20 [03:13<01:37, 13.89s/it]
Steps:  65%|██████▌   | 196/300.0 [03:13<01:04,  1.62it/s][A
Steps:  66%|██████▌   | 197/300.0 [03:14<01:03,  1.62it/s][A
Steps:  66%|██████▌   | 198/300.0 [03:14<01:02,  1.62it/s][A
Steps:  66%|██████▋   | 199/300.0 [03:15<01:02,  1.63it/s][A
Steps:  67%|██████▋   | 200/300.0 [03:16<01:01,  1.63it/s][A
Steps:  67%|██████▋   | 201/300.0 [03:16<01:00,  1.63it/s][A
Steps:  67%|██████▋   | 202/300.0 [03:17<01:00,  1.63it/s][A
Steps:  68%|██████▊   | 203/300.0 [03:18<00:59,  1.63it/s][A
Steps:  68%|██████▊   | 204/300.0 [03:18<00:58,  1.63it/s][A
Steps:  68%|██████▊   | 205/300.0 [03:19<00:58,  1.63it/s][A
Steps:  69%|██████▊   | 206/300.0 [03:19<00:57,  1.63it/s][A
Steps:  69%|██████▉   | 207/300.0 [03:20<00:57,  1.63it/s][A
Steps:  69%|██████▉   | 208/300.0 [03:21<00:56,  1.63it/s][A
Steps:  70%|██████▉   | 209/300.0 [03:21<00:55,  1.63it/s][A
Steps:  70%|███████   | 210/300.0 [03:22<00:55,  1.63it/s][AEpoch:  70%|███████   | 14/20 [03:22<01:14, 12.49s/it]
Steps:  70%|███████   | 211/300.0 [03:22<00:54,  1.63it/s][A
Steps:  71%|███████   | 212/300.0 [03:23<00:53,  1.63it/s][A
Steps:  71%|███████   | 213/300.0 [03:24<00:53,  1.63it/s][A
Steps:  71%|███████▏  | 214/300.0 [03:24<00:52,  1.63it/s][A
Steps:  72%|███████▏  | 215/300.0 [03:25<00:52,  1.63it/s][A
Steps:  72%|███████▏  | 216/300.0 [03:25<00:51,  1.63it/s][A
Steps:  72%|███████▏  | 217/300.0 [03:26<00:51,  1.63it/s][A
Steps:  73%|███████▎  | 218/300.0 [03:27<00:50,  1.63it/s][A
Steps:  73%|███████▎  | 219/300.0 [03:27<00:49,  1.63it/s][A
Steps:  73%|███████▎  | 220/300.0 [03:28<00:49,  1.63it/s][A
Steps:  74%|███████▎  | 221/300.0 [03:29<00:48,  1.63it/s][A
Steps:  74%|███████▍  | 222/300.0 [03:29<00:47,  1.63it/s][A
Steps:  74%|███████▍  | 223/300.0 [03:30<00:47,  1.63it/s][A
Steps:  75%|███████▍  | 224/300.0 [03:30<00:46,  1.64it/s][A
Steps:  75%|███████▌  | 225/300.0 [03:31<00:46,  1.63it/s][AEpoch:  75%|███████▌  | 15/20 [03:31<00:57, 11.50s/it]
Steps:  75%|███████▌  | 226/300.0 [03:32<00:45,  1.62it/s][A
Steps:  76%|███████▌  | 227/300.0 [03:32<00:44,  1.62it/s][A
Steps:  76%|███████▌  | 228/300.0 [03:33<00:44,  1.62it/s][A
Steps:  76%|███████▋  | 229/300.0 [03:33<00:43,  1.62it/s][A
Steps:  77%|███████▋  | 230/300.0 [03:34<00:43,  1.62it/s][A
Steps:  77%|███████▋  | 231/300.0 [03:35<00:42,  1.62it/s][A
Steps:  77%|███████▋  | 232/300.0 [03:35<00:41,  1.62it/s][A
Steps:  78%|███████▊  | 233/300.0 [03:36<00:41,  1.62it/s][A
Steps:  78%|███████▊  | 234/300.0 [03:37<00:40,  1.62it/s][A
Steps:  78%|███████▊  | 235/300.0 [03:37<00:40,  1.62it/s][A
Steps:  79%|███████▊  | 236/300.0 [03:38<00:39,  1.63it/s][A
Steps:  79%|███████▉  | 237/300.0 [03:38<00:38,  1.62it/s][A
Steps:  79%|███████▉  | 238/300.0 [03:39<00:38,  1.62it/s][A
Steps:  80%|███████▉  | 239/300.0 [03:40<00:37,  1.62it/s][A
Steps:  80%|████████  | 240/300.0 [03:40<00:36,  1.62it/s][A11/10/2020 02:44:38 - INFO - EMSE.utils -   Saving checkpoint to ./output/ge_11-10_02-40-38/epoch-ckp-15


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 80.73it/s]


update embedding:   0%|          | 0/7 [00:00<?, ?it/s][A[Aupdate embedding: 100%|██████████| 7/7 [00:00<00:00, 81.70it/s]


random_neg_sampling_dataset:   0%|          | 0/7 [00:00<?, ?it/s][A[Arandom_neg_sampling_dataset: 100%|██████████| 7/7 [00:00<00:00, 46901.16it/s]


Classify Evaluating:   0%|          | 0/4 [00:00<?, ?it/s][A[A

Classify Evaluating:  50%|█████     | 2/4 [00:00<00:00, 12.12it/s][A[A

Classify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 12.99it/s][A[AClassify Evaluating: 100%|██████████| 4/4 [00:00<00:00, 13.63it/s]
                                                      
                                                          [AEpoch:  75%|███████▌  | 15/20 [04:03<00:57, 11.50s/it]
Steps:  80%|████████  | 240/300.0 [04:03<00:36,  1.62it/s][A

retrival evaluation:   0%|          | 0/13 [00:00<?, ?it/s][A[A

retrival evaluation:  62%|██████▏   | 8/13 [00:00<00:00, 71.55it/s][A[Aretrival evaluation: 100%|██████████| 13/13 [00:00<00:00, 71.52it/s]
Epoch:  80%|████████  | 16/20 [04:03<01:11, 17.76s/it]
Steps:  80%|████████  | 241/300.0 [04:04<07:25,  7.55s/it][A
Steps:  81%|████████  | 242/300.0 [04:05<05:17,  5.47s/it][A
Steps:  81%|████████  | 243/300.0 [04:05<03:48,  4.01s/it][A
Steps:  81%|████████▏ | 244/300.0 [04:06<02:47,  2.99s/it][A
Steps:  82%|████████▏ | 245/300.0 [04:06<02:05,  2.28s/it][A
Steps:  82%|████████▏ | 246/300.0 [04:07<01:36,  1.78s/it][A
Steps:  82%|████████▏ | 247/300.0 [04:08<01:15,  1.43s/it][A
Steps:  83%|████████▎ | 248/300.0 [04:08<01:01,  1.19s/it][A
Steps:  83%|████████▎ | 249/300.0 [04:09<00:51,  1.01s/it][A
Steps:  83%|████████▎ | 250/300.0 [04:10<00:44,  1.12it/s][A
Steps:  84%|████████▎ | 251/300.0 [04:10<00:39,  1.23it/s][A
Steps:  84%|████████▍ | 252/300.0 [04:11<00:36,  1.33it/s][A
Steps:  84%|████████▍ | 253/300.0 [04:11<00:33,  1.41it/s][A
Steps:  85%|████████▍ | 254/300.0 [04:12<00:31,  1.46it/s][A
Steps:  85%|████████▌ | 255/300.0 [04:13<00:29,  1.51it/s][AEpoch:  85%|████████▌ | 17/20 [04:13<00:45, 15.19s/it]
Steps:  85%|████████▌ | 256/300.0 [04:13<00:28,  1.54it/s][A
Steps:  86%|████████▌ | 257/300.0 [04:14<00:27,  1.57it/s][A
Steps:  86%|████████▌ | 258/300.0 [04:14<00:26,  1.59it/s][A
Steps:  86%|████████▋ | 259/300.0 [04:15<00:25,  1.60it/s][A
Steps:  87%|████████▋ | 260/300.0 [04:16<00:24,  1.61it/s][A
Steps:  87%|████████▋ | 261/300.0 [04:16<00:24,  1.61it/s][A
Steps:  87%|████████▋ | 262/300.0 [04:17<00:23,  1.62it/s][A
Steps:  88%|████████▊ | 263/300.0 [04:17<00:22,  1.62it/s][A
Steps:  88%|████████▊ | 264/300.0 [04:18<00:22,  1.62it/s][A
Steps:  88%|████████▊ | 265/300.0 [04:19<00:21,  1.62it/s][A
Steps:  89%|████████▊ | 266/300.0 [04:19<00:20,  1.62it/s][A
Steps:  89%|████████▉ | 267/300.0 [04:20<00:20,  1.62it/s][A
Steps:  89%|████████▉ | 268/300.0 [04:21<00:19,  1.62it/s][A
Steps:  90%|████████▉ | 269/300.0 [04:21<00:19,  1.63it/s][A
Steps:  90%|█████████ | 270/300.0 [04:22<00:18,  1.62it/s][AEpoch:  90%|█████████ | 18/20 [04:22<00:26, 13.40s/it]
Steps:  90%|█████████ | 271/300.0 [04:22<00:17,  1.62it/s][A
Steps:  91%|█████████ | 272/300.0 [04:23<00:17,  1.62it/s][A
Steps:  91%|█████████ | 273/300.0 [04:24<00:16,  1.62it/s][A
Steps:  91%|█████████▏| 274/300.0 [04:24<00:15,  1.64it/s][A
Steps:  92%|█████████▏| 275/300.0 [04:25<00:15,  1.63it/s][A
Steps:  92%|█████████▏| 276/300.0 [04:25<00:14,  1.62it/s][A
Steps:  92%|█████████▏| 277/300.0 [04:26<00:14,  1.62it/s][A
Steps:  93%|█████████▎| 278/300.0 [04:27<00:13,  1.62it/s][A
Steps:  93%|█████████▎| 279/300.0 [04:27<00:12,  1.62it/s][A
Steps:  93%|█████████▎| 280/300.0 [04:28<00:12,  1.62it/s][A
Steps:  94%|█████████▎| 281/300.0 [04:29<00:11,  1.62it/s][A
Steps:  94%|█████████▍| 282/300.0 [04:29<00:11,  1.62it/s][A
Steps:  94%|█████████▍| 283/300.0 [04:30<00:10,  1.62it/s][A
Steps:  95%|█████████▍| 284/300.0 [04:30<00:09,  1.62it/s][A
Steps:  95%|█████████▌| 285/300.0 [04:31<00:09,  1.63it/s][AEpoch:  95%|█████████▌| 19/20 [04:31<00:12, 12.15s/it]
Steps:  95%|█████████▌| 286/300.0 [04:32<00:08,  1.62it/s][A
Steps:  96%|█████████▌| 287/300.0 [04:32<00:07,  1.63it/s][A
Steps:  96%|█████████▌| 288/300.0 [04:33<00:07,  1.63it/s][A
Steps:  96%|█████████▋| 289/300.0 [04:34<00:06,  1.63it/s][A
Steps:  97%|█████████▋| 290/300.0 [04:34<00:06,  1.62it/s][A
Steps:  97%|█████████▋| 291/300.0 [04:35<00:05,  1.62it/s][A
Steps:  97%|█████████▋| 292/300.0 [04:35<00:04,  1.62it/s][A
Steps:  98%|█████████▊| 293/300.0 [04:36<00:04,  1.62it/s][A
Steps:  98%|█████████▊| 294/300.0 [04:37<00:03,  1.62it/s][A
Steps:  98%|█████████▊| 295/300.0 [04:37<00:03,  1.63it/s][A
Steps:  99%|█████████▊| 296/300.0 [04:38<00:02,  1.63it/s][A
Steps:  99%|█████████▉| 297/300.0 [04:38<00:01,  1.63it/s][A
Steps:  99%|█████████▉| 298/300.0 [04:39<00:01,  1.62it/s][A
Steps: 100%|█████████▉| 299/300.0 [04:40<00:00,  1.62it/s][A
Steps: 100%|██████████| 300/300.0 [04:40<00:00,  1.62it/s][AEpoch: 100%|██████████| 20/20 [04:40<00:00, 11.28s/it]
                                                          [AEpoch: 100%|██████████| 20/20 [04:40<00:00, 14.04s/it]
11/10/2020 02:45:38 - INFO - EMSE.utils -   Saving checkpoint to ./output/ge_11-10_02-40-38/final_model
Steps: 100%|██████████| 300/300.0 [05:02<00:00,  1.01s/it]
11/10/2020 02:46:01 - INFO - __main__ -   Training finished

evaluate accuracy=0.5


evaluate accuracy=0.5


evaluate accuracy=0.5


evaluate accuracy=0.5

